function domReady(e){window.addEventListener?window.addEventListener("DOMContentLoaded",e,!1):window.attachEvent("onload",e)}var Gauge=function(e){function t(e,a){for(var r in a)"object"==typeof a[r]&&"[object Array]"!==Object.prototype.toString.call(a[r])&&"renderTo"!=r?("object"!=typeof e[r]&&(e[r]={}),t(e[r],a[r])):e[r]=a[r]}function a(){I.width=e.width,I.height=e.height,A=I.cloneNode(!0),E=A.getContext("2d"),P=I.width,C=I.height,S=P/2,F=C/2,j=F>S?S:F,A.i8d=!1,E.translate(S,F),E.save(),B.translate(S,F),B.save()}function r(e){var t=new Date;N=setInterval(function(){var a=new Date-t,r=a/e.duration;r>1&&(r=1);var o="function"==typeof e.delta?e.delta:M[e.delta],i=o(r);e.step(i),1==r&&clearInterval(N)},e.delay||10)}function o(){N&&clearInterval(N);var t=x-k,a=k,o=e.animation;r({delay:o.delay,duration:o.duration,delta:o.fn,step:function(r){k=parseFloat(a)+t*r,e.updateValueOnAnimation?V.setRawValue(k):V.draw()}})}function i(e){return e*Math.PI/180}function n(e,t,a){var r=B.createLinearGradient(0,0,0,a);return r.addColorStop(0,e),r.addColorStop(1,t),r}function l(){var t=j/100*93,a=j-t,r=j/100*91,o=j/100*88,i=j/100*85;B.save(),e.glow&&(B.shadowBlur=a,B.shadowColor=e.colors.circle.shadow),e.circles.outerVisible&&(B.beginPath(),B.arc(0,0,t,0,2*Math.PI,!0),B.fillStyle=n(e.colors.circle.outerStart,e.colors.circle.outerEnd,t),B.fill()),B.restore(),e.circles.middleVisible&&(B.beginPath(),B.arc(0,0,r,0,2*Math.PI,!0),B.fillStyle=n(e.colors.circle.middleStart,e.colors.circle.middleEnd,r),B.fill()),e.circles.innerVisible&&(B.beginPath(),B.arc(0,0,o,0,2*Math.PI,!0),B.fillStyle=n(e.colors.circle.innerStart,e.colors.circle.innerEnd,o),B.fill()),B.beginPath(),B.arc(0,0,i,0,2*Math.PI,!0),B.fillStyle=e.colors.plate,B.fill(),B.save()}function c(t){var a,r=!1;return a=0===e.majorTicksFormat.dec?Math.round(t).toString():t.toFixed(e.majorTicksFormat.dec),e.majorTicksFormat["int"]>1?(r=a.indexOf(".")>-1,a.indexOf("-")>-1?"-"+[e.majorTicksFormat["int"]+e.majorTicksFormat.dec+2+(r?1:0)-a.length].join("0")+a.replace("-",""):[e.majorTicksFormat["int"]+e.majorTicksFormat.dec+1+(r?1:0)-a.length].join("0")+a):a}function s(){var t=j/100*81;if(B.lineWidth=2,B.strokeStyle=e.colors.majorTicks,B.save(),0===e.majorTicks.length){for(var a=5,r=(e.maxValue-e.minValue)/a,o=0;a>o;o++)e.majorTicks.push(c(e.minValue+r*o));e.majorTicks.push(c(e.maxValue))}for(var o=0;o<e.majorTicks.length;++o){var n=e.startAngle+o*(e.ticksAngle/(e.majorTicks.length-1));B.rotate(i(n)),B.beginPath(),B.moveTo(0,t),B.lineTo(0,t-j/100*15),B.stroke(),B.restore(),B.save()}e.strokeTicks&&(B.rotate(i(90)),B.beginPath(),B.arc(0,0,t,i(e.startAngle),i(e.startAngle+e.ticksAngle),!1),B.stroke(),B.restore(),B.save())}function g(){var t=j/100*81;B.lineWidth=1,B.strokeStyle=e.colors.minorTicks,B.save();for(var a=e.minorTicks*(e.majorTicks.length-1),r=0;a>r;++r){var o=e.startAngle+r*(e.ticksAngle/a);B.rotate(i(o)),B.beginPath(),B.moveTo(0,t),B.lineTo(0,t-j/100*7.5),B.stroke(),B.restore(),B.save()}}function f(){for(var t=j/100*55,a={},r=0;r<e.majorTicks.length;++r){var o=e.startAngle+r*(e.ticksAngle/(e.majorTicks.length-1)),n=v(t,i(o));360===o&&(o=0),a[o]||(a[o]=!0,B.font=20*(j/200)+"px Arial",B.fillStyle=e.colors.numbers,B.lineWidth=0,B.textAlign="center",B.fillText(e.majorTicks[r],n.x,n.y+3))}}function u(){e.title&&(B.save(),B.font=24*(j/200)+"px Arial",B.fillStyle=e.colors.title,B.textAlign="center",B.fillText(e.title,0,-j/4.25),B.restore())}function d(){e.units&&(B.save(),B.font=22*(j/200)+"px Arial",B.fillStyle=e.colors.units,B.textAlign="center",B.fillText(e.units,0,j/3.25),B.restore())}function h(t){var a=e.valueFormat.dec,r=e.valueFormat["int"];text=e.valueFormat.text,t=parseFloat(t);var o=0>t;if(t=Math.abs(t),a>0){t=t.toFixed(a).toString().split(".");for(var i=0,n=r-t[0].length;n>i;++i)t[0]="0"+t[0];t=(o?"-":"")+t[0]+"."+t[1]}else{t=Math.round(t).toString();for(var i=0,n=r-t.length;n>i;++i)t="0"+t;t=(o?"-":"")+t}return t+text}function v(e,t){var a=0,r=e,o=Math.sin(t),i=Math.cos(t),n=a*i-r*o,l=a*o+r*i;return{x:n,y:l}}function m(){B.save();for(var t=j/100*81,a=t-j/100*15,r=0,o=e.highlights.length;o>r;r++){var n=e.highlights[r],l=(e.maxValue-e.minValue)/e.ticksAngle,c=i(e.startAngle+(n.from-e.minValue)/l),s=i(e.startAngle+(n.to-e.minValue)/l);B.beginPath(),B.rotate(i(90)),B.arc(0,0,t,c,s,!1),B.restore(),B.save();var g=v(a,c),f=v(t,c);B.moveTo(g.x,g.y),B.lineTo(f.x,f.y);var u=v(t,s),d=v(a,s);B.lineTo(u.x,u.y),B.lineTo(d.x,d.y),B.lineTo(g.x,g.y),B.closePath(),B.fillStyle=n.color,B.fill(),B.beginPath(),B.rotate(i(90)),B.arc(0,0,a,c-.2,s+.2,!1),B.restore(),B.closePath(),B.fillStyle=e.colors.plate,B.fill(),B.save()}}function p(){var t=j/100*e.needle.circle.size,a=j/100*e.needle.circle.size*.75,r=j/100*e.needle.end,o=e.needle.start?j/100*e.needle.start:0,l=j/100*20,c=j/100*e.needle.width,s=j/100*e.needle.width/2,g=function(){B.shadowOffsetX=2,B.shadowOffsetY=2,B.shadowBlur=10,B.shadowColor=e.colors.needle.shadowDown};g(),B.save(),B.rotate(i(e.startAngle+(k-e.minValue)/(e.maxValue-e.minValue)*e.ticksAngle)),"arrow"===e.needle.type?(B.beginPath(),B.moveTo(-s,-l),B.lineTo(-c,0),B.lineTo(-1,r),B.lineTo(1,r),B.lineTo(c,0),B.lineTo(s,-l),B.closePath(),B.fillStyle=n(e.colors.needle.start,e.colors.needle.end,r-l),B.fill(),B.beginPath(),B.lineTo(-.5,r),B.lineTo(-1,r),B.lineTo(-c,0),B.lineTo(-s,-l),B.lineTo(s/2-2,-l),B.closePath(),B.fillStyle=e.colors.needle.shadowUp,B.fill()):(B.beginPath(),B.moveTo(-s,r),B.lineTo(-s,o),B.lineTo(s,o),B.lineTo(s,r),B.closePath(),B.fillStyle=n(e.colors.needle.start,e.colors.needle.end,r-l),B.fill()),B.restore(),e.needle.circle&&(g(),e.needle.circle.outer&&(B.beginPath(),B.arc(0,0,t,0,2*Math.PI,!0),B.fillStyle=n(e.colors.needle.circle.outerStart,e.colors.needle.circle.outerEnd,t),B.fill(),B.restore()),e.needle.circle.inner&&(B.beginPath(),B.arc(0,0,a,0,2*Math.PI,!0),B.fillStyle=n(e.colors.needle.circle.innerStart,e.colors.needle.circle.innerEnd,a),B.fill()))}function w(e,t,a,r,o){B.beginPath(),B.moveTo(e+o,t),B.lineTo(e+a-o,t),B.quadraticCurveTo(e+a,t,e+a,t+o),B.lineTo(e+a,t+r-o),B.quadraticCurveTo(e+a,t+r,e+a-o,t+r),B.lineTo(e+o,t+r),B.quadraticCurveTo(e,t+r,e,t+r-o),B.lineTo(e,t+o),B.quadraticCurveTo(e,t,e+o,t),B.closePath()}function b(){if(e.valueText.visible){B.save(),B.font=35*(j/200)+"px Led";var t=h(T),a=j-j/100*33,r=0;if(B.save(),e.valueBox.visible){var o=.12*j,i=B.measureText("-"+h(0)).width;w(-i/2-.025*j,a-o-.04*j,i+.05*j,o+.07*j,.025*j)}var n=B.createRadialGradient(r,a-.12*j-.025*j+(.12*j+.045*j)/2,j/10,r,a-.12*j-.025*j+(.12*j+.045*j)/2,j/5);n.addColorStop(0,e.colors.valueBox.rectStart),n.addColorStop(1,e.colors.valueBox.rectEnd),B.strokeStyle=n,B.lineWidth=.05*j,B.stroke(),B.shadowBlur=.012*j,B.shadowColor=e.colors.valueBox.shadow,B.fillStyle=e.colors.valueBox.background,B.fill(),B.restore(),B.shadowOffsetX=.004*j,B.shadowOffsetY=.004*j,B.shadowBlur=.012*j,B.shadowColor=e.colors.valueText.shadow,B.fillStyle=e.colors.valueText.foreground,B.textAlign="center",B.fillText(t,-r,a),B.restore()}}Gauge.Collection.push(this),this.config={renderTo:null,width:200,height:200,title:!1,maxValue:100,minValue:0,majorTicks:[],minorTicks:10,ticksAngle:270,startAngle:45,strokeTicks:!0,units:!1,updateValueOnAnimation:!1,valueFormat:{"int":3,dec:2},majorTicksFormat:{"int":1,dec:0},glow:!0,animation:{delay:10,duration:250,fn:"cycle"},colors:{plate:"#fff",majorTicks:"#444",minorTicks:"#666",title:"#888",units:"#888",numbers:"#444",needle:{start:"rgba(240, 128, 128, 1)",end:"rgba(255, 160, 122, .9)",circle:{outerStart:"#f0f0f0",outerEnd:"#ccc",innerStart:"#e8e8e8",innerEnd:"#f5f5f5"},shadowUp:"rgba(2, 255, 255, 0.2)",shadowDown:"rgba(188, 143, 143, 0.45)"},valueBox:{rectStart:"#CFCFCF",rectEnd:"#d7d4d4",background:"#EFEFEF",shadow:"rgba(0, 0, 0, 0.3)"},valueText:{foreground:"#76727A",shadow:"rgba(255, 255, 255, 0.3)"},circle:{shadow:"rgba(0, 0, 0, 0.5)",outerStart:"#ddd",outerEnd:"#aaa",middleStart:"#eee",middleEnd:"#f0f0f0",innerStart:"#fafafa",innerEnd:"#ccc"}},needle:{type:"arrow",start:0,end:77,width:4,circle:{size:10,inner:!0,outer:!0}},circles:{outerVisible:!0,middleVisible:!0,innerVisible:!0},valueBox:{visible:!0},valueText:{visible:!0},highlights:[{from:20,to:60,color:"#eee"},{from:60,to:80,color:"#ccc"},{from:80,to:100,color:"#999"}]};var T=0,V=this,k=0,x=0,y=!1;if(this.setValue=function(t){k=e.animation?T:t;var a=(e.maxValue-e.minValue)/100;return x=t>e.maxValue?e.maxValue+a:t<e.minValue?e.minValue-a:t,T=t,e.animation?o():this.draw(),this},this.setRawValue=function(e){return k=T=e,this.draw(),this},this.clear=function(){return T=k=x=this.config.minValue,this.draw(),this},this.getValue=function(){return T},this.onready=function(){},t(this.config,e),e.startAngle=parseInt(e.startAngle,10),e.ticksAngle=parseInt(e.ticksAngle,10),isNaN(e.startAngle)&&(e.startAngle=45),isNaN(e.ticksAngle)&&(e.ticksAngle=270),e.ticksAngle>360&&(e.ticksAngle=360),e.ticksAngle<0&&(e.ticksAngle=0),e.startAngle<0&&(e.startAngle=0),e.startAngle>360&&(e.startAngle=360),this.config.minValue=parseFloat(this.config.minValue),this.config.maxValue=parseFloat(this.config.maxValue),e=this.config,k=T=e.minValue,!e.renderTo)throw Error("Canvas element was not specified when creating the Gauge object!");var A,P,C,S,F,j,E,I=e.renderTo.tagName?e.renderTo:document.getElementById(e.renderTo),B=I.getContext("2d");a(),this.updateConfig=function(e){return t(this.config,e),a(),this.setRawValue(T||0),this};var M={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},quint:function(e){return Math.pow(e,5)},cycle:function(e){return 1-Math.sin(Math.acos(e))},bounce:function(e){return 1-function(e){for(var t=0,a=1;1;t+=a,a/=2)if(e>=(7-4*t)/11)return-Math.pow((11-6*t-11*e)/4,2)+Math.pow(a,2)}(1-e)},elastic:function(e){return 1-function(e){var t=1.5;return Math.pow(2,10*(e-1))*Math.cos(20*Math.PI*t/3*e)}(1-e)}},N=null;B.lineCap="round",this.isWaitingForInitialization=!1,this.drawWhenInitialized=function(){return Gauge.initialized?(this.isWaitingForInitialization=!1,b(),p(),y||(V.onready&&V.onready(),y=!0),!0):(this.isWaitingForInitialization=!0,!1)},this.draw=function(){if(!A.i8d){E.clearRect(-S,-F,P,C),E.save();var e={ctx:B};B=E,l(),m(),g(),s(),f(),u(),d(),A.i8d=!0,B=e.ctx,delete e.ctx}B.clearRect(-S,-F,P,C),B.save(),B.drawImage(A,-S,-F,P,C),this.drawWhenInitialized()}};Gauge.initialized=!1,function(){function e(){Gauge.initialized=!0;for(var e=0;e<Gauge.Collection.length;++e)Gauge.Collection[e].isWaitingForInitialization&&Gauge.Collection[e].drawWhenInitialized()}function t(){var t,n=a.getElementsByTagName("head")[0],l="@font-face { font-family: '"+i+"'; src: "+o+"; }",c=a.createElement("style");if(c.type="text/css",r)n.appendChild(c),t=c.styleSheet,t.cssText=l;else{try{c.appendChild(a.createTextNode(l))}catch(s){c.cssText=l}n.appendChild(c),t=c.styleSheet?c.styleSheet:c.sheet||a.styleSheets[a.styleSheets.length-1]}var g=setInterval(function(){if(a.body){clearInterval(g);var t=a.createElement("div");t.style.fontFamily=i,t.style.position="absolute",t.style.height=t.style.width=0,t.style.overflow="hidden",t.innerHTML=".",a.body.appendChild(t),setTimeout(function(){e(),t.parentNode.removeChild(t)},250)}},1)}var a=document,r=-1!=navigator.userAgent.toLocaleLowerCase().indexOf("msie"),o="url('"+(window.CANV_GAUGE_FONTS_PATH||"fonts")+"/digital-7-mono."+(r?"eot":"ttf")+"')",i="Led";if(void 0===document.fonts)t();else{var n=new window.FontFace(i,o);document.fonts.add(n),n.load().then(function(t){e()},function(e){window.console&&window.console.log(e),t()})}}(),Gauge.Collection=[],Gauge.Collection.get=function(e){var t=this;if("string"!=typeof e)return"number"==typeof e?t[e]:null;for(var a=0,r=t.length;r>a;a++){var o=t[a].config.renderTo.tagName?t[a].config.renderTo:document.getElementById(t[a].config.renderTo);if(o.getAttribute("id")==e)return t[a]}},domReady(function(){function toCamelCase(e){for(var t=e[0],a=1,r=e.length;r>a;a++)t+=e[a].substr(0,1).toUpperCase()+e[a].substr(1,e[a].length-1);return t}function trim(e){return e.replace(/^\s+|\s+$/g,"")}for(var c=document.getElementsByTagName("canvas"),i=0,s=c.length;s>i;i++)if("canv-gauge"==c[i].getAttribute("data-type")){var gauge=c[i],config={},prop,w=parseInt(gauge.getAttribute("width"),10),h=parseInt(gauge.getAttribute("height"),10);config.renderTo=gauge,w&&(config.width=w),h&&(config.height=h);for(var ii=0,ss=gauge.attributes.length;ss>ii;ii++)if(prop=gauge.attributes.item(ii).nodeName,"data-type"!=prop&&"data-"==prop.substr(0,5)){var cfgProp=prop.substr(5,prop.length-5).toLowerCase().split("-"),attrValue=gauge.getAttribute(prop);if(!attrValue)continue;switch(cfgProp[0]){case"needle":config.needle||(config.needle={}),"circle"==cfgProp[1]?(config.needle.circle||(config.needle.circle={}),cfgProp[2]?config.needle.circle[cfgProp[2]]="false"===attrValue?!1:attrValue:config.needle.circle="false"==attrValue?!1:attrValue):config.needle[cfgProp[1]]=attrValue;break;case"ticksangle":config.ticksAngle=parseInt(attrValue,10),config.ticksAngle>360&&(config.ticksAngle=360),config.ticksAngle<0&&(config.ticksAngle=0);break;case"startangle":config.startAngle=parseInt(attrValue,10),config.startAngle>360&&(config.startAngle=360),config.startAngle<0&&(config.startAngle=0);break;case"colors":if(cfgProp[1])if(config.colors||(config.colors={}),config.colors.needle||(config.colors.needle={}),"needle"==cfgProp[1]){if(cfgProp[2])switch(cfgProp[2]){case"start":config.colors.needle.start=attrValue;break;case"end":config.colors.needle.end=attrValue}else{var parts=attrValue.split(/\s+/);parts[0]&&parts[1]?(config.colors.needle.start=parts[0],config.colors.needle.end=parts[1]):config.colors.needle.start=attrValue}if(cfgProp[2])switch(config.colors.needle.circle||(config.colors.needle.circle={}),cfgProp[2]){case"circle":switch(cfgProp[3]){case"outerstart":config.colors.needle.circle.outerStart=attrValue;break;case"outerend":config.colors.needle.circle.outerEnd=attrValue;break;case"innerstart":config.colors.needle.circle.innerStart=attrValue;break;case"innerend":config.colors.needle.circle.innerEnd=attrValue}case"shadowup":config.colors.needle.shadowUp=attrValue;break;case"shadowdown":config.colors.needle.shadowDown=attrValue}}else if("valuebox"==cfgProp[1]){if(config.colors.valueBox||(config.colors.valueBox={}),cfgProp[2])switch(cfgProp[2]){case"rectstart":config.colors.valueBox.rectStart=attrValue;break;case"rectend":config.colors.valueBox.rectEnd=attrValue;break;case"background":config.colors.valueBox.background=attrValue;break;case"shadow":config.colors.valueBox.shadow=attrValue}}else if("valuetext"==cfgProp[1]){if(config.colors.valueText||(config.colors.valueText={}),cfgProp[2])switch(cfgProp[2]){case"foreground":config.colors.valueText.foreground=attrValue;break;case"shadow":config.colors.valueText.shadow=attrValue}}else if("circle"==cfgProp[1]){if(config.colors.circle||(config.colors.circle={}),cfgProp[2])switch(cfgProp[2]){case"shadow":config.colors.circle.shadow=attrValue;break;case"outerstart":config.colors.circle.outerStart=attrValue;break;case"outerend":config.colors.circle.outerEnd=attrValue;break;case"middlestart":config.colors.circle.middleStart=attrValue;break;case"middleend":config.colors.circle.middleEnd=attrValue;break;case"innerstart":config.colors.circle.innerStart=attrValue;break;case"innerend":config.colors.circle.innerEnd=attrValue}}else cfgProp.shift(),config.colors[toCamelCase(cfgProp)]=attrValue;break;case"circles":if(config.circles||(config.circles={}),cfgProp[1])switch(cfgProp[1]){case"outervisible":config.circles.outerVisible="true"===attrValue.toLowerCase();break;case"middlevisible":config.circles.middleVisible="true"===attrValue.toLowerCase();break;case"innervisible":config.circles.innerVisible="true"===attrValue.toLowerCase()}break;case"valuebox":if(config.valueBox||(config.valueBox={}),cfgProp[1])switch(cfgProp[1]){case"visible":config.valueBox.visible="true"===attrValue.toLowerCase()}break;case"valuetext":if(config.valueText||(config.valueText={}),cfgProp[1])switch(cfgProp[1]){case"visible":config.valueText.visible="true"===attrValue.toLowerCase()}break;case"highlights":if("false"===attrValue){config.highlights=[];break}config.highlights||(config.highlights=[]);for(var hls=attrValue.match(/(?:(?:-?\d*\.)?(-?\d+){1,2} ){2}(?:(?:#|0x)?(?:[0-9A-F|a-f]){3,8}|rgba?\(.*?\))/g),j=0,l=hls.length;l>j;j++){var cfg=trim(hls[j]).split(/\s+/),hlCfg={};cfg[0]&&""!=cfg[0]&&(hlCfg.from=cfg[0]),cfg[1]&&""!=cfg[1]&&(hlCfg.to=cfg[1]),cfg[2]&&""!=cfg[2]&&(hlCfg.color=cfg[2]),config.highlights.push(hlCfg)}break;case"animation":cfgProp[1]&&(config.animation||(config.animation={}),"fn"==cfgProp[1]&&/^\s*function\s*\(/.test(attrValue)&&(attrValue=eval("("+attrValue+")")),config.animation[cfgProp[1]]=attrValue);break;default:var cfgName=toCamelCase(cfgProp);if("onready"==cfgName)continue;if("majorTicks"==cfgName)attrValue=attrValue.split(/\s+/);else if("strokeTicks"==cfgName||"glow"==cfgName)attrValue="true"==attrValue?!0:!1;else if("valueFormat"==cfgName){var val=attrValue.split(".");if(2!=val.length)continue;attrValue={"int":parseInt(val[0],10),dec:parseInt(val[1],10)}}else"updateValueOnAnimation"===cfgName&&(attrValue="true"===attrValue?!0:!1);config[cfgName]=attrValue}}var g=new Gauge(config);gauge.getAttribute("data-value")&&g.setRawValue(parseFloat(gauge.getAttribute("data-value"))),gauge.getAttribute("data-onready")&&(g.onready=function(){eval(this.config.renderTo.getAttribute("data-onready"))}),g.draw()}}),window.Gauge=Gauge;